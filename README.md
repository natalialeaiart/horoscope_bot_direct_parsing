# Telegram-бот для астрологических прогнозов

Этот проект представляет собой Telegram-бота, который ежедневно публикует пост с кнопками выбора знака зодиака и отправляет персональные гороскопы по запросу пользователя. Гороскопы парсятся напрямую с сайта [astrology.com](https://www.astrology.com/horoscope/daily.html) и переводятся на русский язык с помощью OpenAI API (ChatGPT 4o mini).

## Особенности

- Ежедневная публикация поста с кнопками выбора знака зодиака в 9:00 по рижскому времени
- Персональные гороскопы по запросу пользователя
- Автоматический парсинг данных с astrology.com
- Перевод гороскопов с английского на русский с помощью ChatGPT 4o mini
- Круглосуточная работа бота на Render.com

## Структура проекта

```
horoscope_bot/
├── main.py           # Основной скрипт для запуска бота
├── parser.py         # Модуль для парсинга гороскопов с astrology.com
├── translator.py     # Модуль для перевода гороскопов с помощью OpenAI API
├── requirements.txt  # Зависимости проекта
├── .env.example      # Пример файла с переменными окружения
├── render.yaml       # Конфигурация для Render.com
└── README.md         # Документация проекта
```

## Требования

- Python 3.7+
- Токен Telegram бота
- ID Telegram канала
- API ключ OpenAI
- Аккаунт на Render.com (бесплатный план подходит)

## Установка и запуск локально

1. Клонируйте репозиторий:
```bash
git clone https://github.com/ваш-username/horoscope-bot.git
cd horoscope-bot
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Создайте файл `.env` на основе `.env.example`:
```bash
cp .env.example .env
```

4. Отредактируйте файл `.env`, добавив свои данные:
```
TELEGRAM_BOT_TOKEN=ваш_токен_бота
TELEGRAM_CHANNEL_ID=ваш_id_канала
OPENAI_API_KEY=ваш_ключ_openai
```

5. Запустите бота в режиме обработки команд:
```bash
python main.py --run-bot
```

6. Для отправки ежедневного поста:
```bash
python main.py --daily-post
```

## Деплой на Render.com

1. Создайте аккаунт на [Render.com](https://render.com/) (бесплатный план подходит)

2. Загрузите репозиторий на GitHub

3. В Render.com создайте новый Web Service:
   - Подключите ваш GitHub репозиторий
   - Выберите тип "Web Service"
   - Выберите план "Free"
   - Укажите следующие настройки:
     - Build Command: `pip install -r requirements.txt`
     - Start Command: `python main.py --run-bot`

4. Добавьте переменные окружения в настройках сервиса:
   - TELEGRAM_BOT_TOKEN=ваш_токен_бота
   - TELEGRAM_CHANNEL_ID=ваш_id_канала
   - OPENAI_API_KEY=ваш_ключ_openai

5. Нажмите "Create Web Service"

## Настройка ежедневного постинга

Для настройки ежедневного постинга в 9:00 по рижскому времени, создайте в Render.com еще один сервис типа "Cron Job":

1. В Render.com выберите "New" -> "Cron Job"
2. Подключите тот же GitHub репозиторий
3. Укажите следующие настройки:
   - Schedule: `0 9 * * *` (запуск каждый день в 9:00)
   - Timezone: Europe/Riga
   - Command: `python main.py --daily-post`
4. Добавьте те же переменные окружения:
   - TELEGRAM_BOT_TOKEN=ваш_токен_бота
   - TELEGRAM_CHANNEL_ID=ваш_id_канала
   - OPENAI_API_KEY=ваш_ключ_openai
5. Нажмите "Create Cron Job"

## Как это работает

1. Модуль `parser.py` получает гороскопы с сайта astrology.com
2. Модуль `translator.py` переводит гороскопы с английского на русский с помощью OpenAI API
3. Веб-сервис на Render.com запускает бота в режиме обработки команд, что позволяет обрабатывать нажатия на кнопки 24/7
4. Cron Job на Render.com запускается каждый день в 9:00 и отправляет пост с кнопками в канал
5. Когда пользователь нажимает на кнопку, бот получает гороскоп, переводит его и отправляет пользователю

## Устранение неполадок

- **Бот не отвечает на нажатия кнопок**: Убедитесь, что веб-сервис на Render.com запущен и работает
- **Ежедневный пост не публикуется**: Проверьте настройки Cron Job и переменные окружения
- **Ошибка при получении гороскопов**: Убедитесь, что сайт astrology.com доступен и структура страницы не изменилась
- **Ошибка при переводе**: Проверьте ваш API ключ OpenAI и лимиты использования

## Лицензия

MIT
